<dl class="portlet portletExamplePortlet"
    i18n:domain="pleiades.portlet.flickr">

    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
        Photos
        <span class="portletTopRight"></span>
    </dt>

    <div>
      <a id="flickr-portrait-link" href="" style="display:none"><img width="180" id="flickr-portrait" src="" title=""/></a>
      <p id="flickr-portrait-attribution" style="display:none"><span></span> from the  <a href="http://www.flickr.com/groups/pleiades-places/pool/">Pleiades Places pool on Flickr</a></p>
      <p id="flickr-portrait-loading">Loading...</p>
      <p id="flickr-portrait-tip" style="display:none">This place has no portrait photo. One from the list of related photos could be suggested for the <a href="http://flickr.com/groups/1876758@N22/">Pleiades Places group on Flickr</a>.</p>
      <p id="flickr-photos-link"><a id="flickr-photos-link" href="#"><span id="flickr-photos-count">0</span> other related photos...</a></p>
    </div>

<script type="text/javascript">
<!--
  
  function queryFlickr() {
    jq.ajax({
      "url": document.baseURI + "/@@flickr-tagged",
      "success": function (data) {
        jq("#flickr-photos-count").html(data['related']['total']);
        jq("#flickr-photos-link a").attr("href", data['related']['url']);
        if (data['portrait'] == null) {
          jq("#flickr-portrait-loading").hide();
          jq("#flickr-portrait-tip").show();
        }
        else {
          jq("#flickr-portrait").attr("src", data['portrait']['img']);
          jq("#flickr-portrait").attr("title", data['portrait']['title']);
          jq("#flickr-portrait-link").attr("href", data['portrait']['page']);
          jq("#flickr-portrait-attribution").html(data['portrait']['title']);
          jq("#flickr-portrait-loading").hide();
          jq("#flickr-portrait-link").show();
          jq("#flickr-portrait-attribution").show();
        }
      },
      "error": function (req, status, err) {
        jq("#flickr-portrait-loading").hide();
        jq("#flickr-portrait-attribution").hide();
        jq("#flickr-photos-link").hide();
        jq("#flickr-portrait-tip").html("Photo API has not responded. Reload the page after a minute or two.");
        jq("#flickr-portrait-tip").show();
      }
    });
  }

  jq(document).ready(queryFlickr);

  -->
</script>

</dl>
